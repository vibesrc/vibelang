// Test impl blocks and method calls

struct Counter {
    value: i64
}

impl Counter {
    fn new() -> Counter {
        return Counter { value: 0 }
    }

    fn get(&self) -> i64 {
        return self.value
    }

    fn increment(~self) {
        self.value = self.value + 1
    }

    fn add(&self, other: &Counter) -> i64 {
        return self.value + other.value
    }
}

fn main() -> i64 {
    // Static constructor
    let c = Counter.new()
    if c.get() != 0 {
        return 1
    }

    // Mutable method
    c.increment()
    if c.get() != 1 {
        return 2
    }

    c.increment()
    c.increment()
    if c.get() != 3 {
        return 3
    }

    // Method with reference argument
    let c1 = Counter { value: 10 }
    let c2 = Counter { value: 20 }
    let sum = c1.add(&c2)
    if sum != 30 {
        return 4
    }

    return 0
}
