// Test closures that capture variables from outer scope

fn main() -> i32 {
    // Test 1: Capture a single variable
    let multiplier = 10
    let scale = fn(x: i32) x * multiplier
    let result1 = scale(5)  // Should be 50

    if result1 != 50 {
        print("FAIL: scale(5) should be 50\n")
        return 1
    }

    // Test 2: Capture multiple variables
    let a = 3
    let b = 4
    let add_both = fn(x: i32) x + a + b
    let result2 = add_both(10)  // Should be 17

    if result2 != 17 {
        print("FAIL: add_both(10) should be 17\n")
        return 1
    }

    // Test 3: Closure in block body
    let outer = 100
    let make_adder = fn(n: i32) -> i32 {
        return n + outer
    }
    let result3 = make_adder(5)  // Should be 105

    if result3 != 105 {
        print("FAIL: make_adder(5) should be 105\n")
        return 1
    }

    print("All closure capture tests passed!\n")
    return 0
}
